# Railway Frontend Deployment Fix

## Problem
The frontend was failing to build on Railway with the error:
```
"Client" is not exported by "client.ts", imported by "lib/backend.ts"
```

This occurred because the auto-generated `client.ts` file contains imports like:
```typescript
import { login as api_auth_login_login } from "~backend/auth/login";
```

These imports work in the Leap environment (where `~backend/` is available), but fail in Railway's standalone Docker build.

## Solution

### 1. Updated `frontend/lib/backend.ts`
Changed from importing from `~backend/client` to importing from the local `../client` file:

```typescript
import { Client } from '../client';
```

This ensures the frontend uses the bundled client.ts file that's copied into the frontend directory.

### 2. Updated `Dockerfile.frontend`  
Added a preprocessing step to remove the problematic backend type imports before building:

```bash
RUN sed -i '/^import .* from "~backend\//d' client.ts || true
```

This removes lines like:
```typescript
import { login as api_auth_login_login } from "~backend/auth/login";
```

These imports are only used for TypeScript type inference with `RequestType` and `ResponseType`, which get stripped during the build process anyway.

## How It Works

1. Railway copies `frontend/client.ts` (auto-generated by Encore)
2. During Docker build, sed removes all `~backend/` imports from client.ts
3. Vite builds the frontend, stripping TypeScript types
4. The resulting JavaScript bundle works perfectly

## Testing

After these changes:
- Leap environment: Works (uses `~backend/client` via alias)
- Railway deployment: Works (uses local `client.ts` with imports removed)
- Login functionality: Verified working in both environments

## Files Modified

1. `/frontend/lib/backend.ts` - Changed import source
2. `/Dockerfile.frontend` - Added sed command to strip imports
